var LIST_ID="MEMessageList",gListFirstLoad=!0,gListMethod="LIST-MESSAGES",gListParams="",gServerIPP=0;
function ProcessMessageList(b,e){var g=0,l=0;DataItemList_ValidateContext(b);var d=b.attributes;(gTotalItems=parseInt(GetXMLValue(d.getNamedItem("TOTAL_ITEMS"))))||(gTotalItems=0);var m=parseInt(GetXMLValue(d.getNamedItem("PAGE")));gItemsArrayServerTopIndex=parseInt(GetXMLValue(d.getNamedItem("TOP_INDEX")));var f=parseInt(GetXMLValue(d.getNamedItem("SCHEMA2")));var K=parseInt(GetXMLValue(d.getNamedItem("ITEMS_CURRENT_PAGE")));gServerIPP=parseInt(GetXMLValue(d.getNamedItem("IPP")));var L=GetXMLValue(d.getNamedItem("SORT_COLUMN"));
var M=GetXMLValue(d.getNamedItem("SORT_ORDER"));gUnreadMessages=parseInt(GetXMLValue(d.getNamedItem("UNREAD_MESSAGES")));var N=GetXMLValue(d.getNamedItem("FOLDER_PATH"));d=GetXMLValue(b.getElementsByTagName("URI")[0]);gItemsPerPage=CalculateItemsPerPage(gMsgListHeight,gUnitScrollLength);gSourceURI=d&&0<d.length?d:"";gSecondPageNum=m;gThirdPageNum=gSecondPageNum+1;gFirstPageNum=gSecondPageNum-1;if(gTotalItems<gItemsPerPage){var n=0;var p=gTotalItems-1}else n=0,p=gItemsPerPage-1;if(1==f){b.getElementsByTagName("E")&&
(g=b.getElementsByTagName("E").length);oItemsArray=Array(g);var q="F",r="FR",t="SZ",u="SF",v="S",w="R",x="RF",y="RD",z="C",A="FL",B="A",C="I",D="CA"}else b.getElementsByTagName("ELEMENT")&&(g=b.getElementsByTagName("ELEMENT").length),oItemsArray=Array(g),q="FROM",r="FROM_RAW",t="SIZE",u="SIZE_FULL",v="SUBJECT",w="RECEIVED",x="RECEIVED_FULL",y="READ",z="CLASS",A="FLAGS",B="ATTACHMENTS",C="IMPORTANCE",D="CATEGORIES";oItemsArray=Array(g);gListFirstLoad&&DataItemList_ClearListContents(LIST_ID);0==g&&
DataItemList_AddEmptyListMessageRow(LIST_ID,t_("[ME_TXT-Therearenoitemstoshowinthisview]"));for(f=0;f<g;f++){var c=b.childNodes[f];var k=c.attributes;var O=GetXMLValue(k.getNamedItem("ID"));k=GetXMLValue(c.getElementsByTagName(q)[0]);var P=GetXMLValue(c.getElementsByTagName(r)[0]);var Q=GetXMLValue(c.getElementsByTagName(t)[0]);var R=GetXMLValue(c.getElementsByTagName(u)[0]);var E=GetXMLValue(c.getElementsByTagName(v)[0]);var S=GetXMLValue(c.getElementsByTagName(w)[0]);var T=GetXMLValue(c.getElementsByTagName(x)[0]);
var F=GetXMLValue(c.getElementsByTagName(y)[0]);var h=GetXMLValue(c.getElementsByTagName(A)[0]);try{var G=GetXMLValue(c.getElementsByTagName(D)[0])}catch(U){G=""}try{var H=GetXMLValue(c.getElementsByTagName(z)[0])}catch(U){H=""}null!=h&&(F=null!=h.toUpperCase().match("\\SEEN")?1:0);var I=0;null!=h&&-1!=h.search(/FLAGGED/i)&&(I=1);var J=0;null!=h&&-1!=h.search(/DELETED/i)&&(J=1);var V=GetXMLValue(c.getElementsByTagName(B)[0]);c=GetXMLValue(c.getElementsByTagName(C)[0]);var a=[];a.MessageID=O;a.From=
k;a.From_Full=P;a.Size=Q;a.Size_Full=R+" Bytes";a.Subject=E;a.Subject_Full=E;a.RecvDate=S;a.RecvDate_Full=T;a.Read=F;a.Flags=h;a.Flagged=I;a.Deleted=J;a.Attachments=V;a.Importance=c;a.URI=d;a.Folder=N;a.Class=H;a.Categories=G;oItemsArray[f]=a;gListFirstLoad&&(f>=n&&f<=p&&(DataItemList_AddRowToList(LIST_ID,oItemsArray[f],e,f),l++),gCurrSelectedPage=1)}gRowsDrawn=l;DataItemList_SetSortColumnIcon(L,M);DataItemList_SetItemCount(LIST_ID,gTotalItems);1==m&&(gPrevFirstScrollPos=0,gPrevLastScrollPos=K-1,
gSecondPageNum=1,DataItemList_SetScrollBarPosition(0));return gMessagesRetrieved=!0}function ProcessSelectedIDs(b){var e="";if(IsIE(gBrowserType))try{(e=b.xml)||(e=(new XMLSerializer).serializeToString(b))}catch(g){e=""}else e=(new XMLSerializer).serializeToString(b);b=GetXMLNodeVal(e,"SELECTED_MESSAGES");if(0<b.length)for(gSelectedIM.Clear(),b=b.split(","),e=0;e<b.length;e++)gSelectedIM.AddItem(b[e]);DataItemList_SelectSelectedRows(LIST_ID)};
